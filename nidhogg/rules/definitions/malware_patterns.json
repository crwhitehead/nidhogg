[
    {
      "id": "MAL-EXEC-001",
      "name": "Dynamic Code Execution",
      "description": "Use of eval/exec with string argument",
      "category": "code_execution",
      "severity": "high",
      "detection": {
        "opcode_sequence": ["LOAD_NAME", "LOAD_CONST", "CALL_FUNCTION"],
        "name": ["eval", "exec"],
        "context": "function_call"
      },
      "reference": "https://owasp.org/www-community/attacks/Code_Injection"
    },
    {
      "id": "MAL-OBFUS-001",
      "name": "Base64 String Decoding",
      "description": "Use of base64 decode with suspicious string",
      "category": "obfuscation",
      "severity": "medium",
      "detection": {
        "function_call": "base64.b64decode",
        "context": "with_string_arg"
      },
      "reference": "https://attack.mitre.org/techniques/T1027/"
    },
    {
      "id": "MAL-PERSIST-001",
      "name": "Registry Persistence",
      "description": "Modifying autorun registry keys for persistence",
      "category": "persistence",
      "severity": "high",
      "detection": {
        "registry_keys": [
          "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
          "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce",
          "HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run"
        ],
        "context": "write_operation"
      },
      "reference": "https://attack.mitre.org/techniques/T1547/001/"
    },
    {
      "id": "MAL-NET-001",
      "name": "Suspicious Network Connection",
      "description": "Connection to known bad IP or suspicious port",
      "category": "network",
      "severity": "high",
      "detection": {
        "ports": [4444, 8080, 1337, 31337, 6666],
        "context": "outbound_connection"
      },
      "reference": "https://attack.mitre.org/techniques/T1071/"
    },
    {
      "id": "MAL-FILE-001",
      "name": "Suspicious File Access",
      "description": "Access to sensitive system files",
      "category": "file",
      "severity": "medium",
      "detection": {
        "paths": [
          "/etc/passwd",
          "/etc/shadow",
          "C:\\Windows\\System32",
          "/bin/",
          "/sbin/"
        ],
        "context": "file_access"
      },
      "reference": "https://attack.mitre.org/techniques/T1083/"
    },
    {
      "id": "MAL-EVASION-001",
      "name": "Anti-Analysis Detection",
      "description": "Checks for debugging or analysis environment",
      "category": "evasion",
      "severity": "high",
      "detection": {
        "imports": ["platform", "socket", "subprocess"],
        "function_calls": ["platform.platform", "socket.gethostname"],
        "context": "environment_check"
      },
      "reference": "https://attack.mitre.org/techniques/T1497/"
    }
  ]